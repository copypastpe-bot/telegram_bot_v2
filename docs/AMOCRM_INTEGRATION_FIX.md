# Восстановление интеграции с amoCRM

## Проблема

Сообщения из клиентского бота перестали попадать в amoCRM после добавления собственного бэкенда.

## Причина

Когда бот обрабатывает сообщения через `aiogram`, они не пересылаются в amoCRM автоматически. Нужно явно отправлять сообщения в Wahelp, который пересылает их в amoCRM.

## Решение

Добавить отправку сообщений в Wahelp при получении сообщений от клиентов.

### Шаг 1: Добавить интеграцию с Wahelp

Создать модуль для работы с Wahelp API (аналогично админ-боту).

### Шаг 2: Отправлять сообщения в Wahelp

При получении сообщения от клиента:
1. Найти клиента в БД по `bot_tg_user_id`
2. Получить его телефон
3. Отправить сообщение в Wahelp через канал `clients_tg`
4. Wahelp автоматически перешлёт в amoCRM

### Шаг 3: Обработать все входящие сообщения

Добавить обработчик для всех сообщений от клиентов (не только вопросы/заказы).

---

## Что нужно сделать:

1. **Скопировать модуль Wahelp** из админ-бота в клиентский бот
2. **Добавить отправку в Wahelp** при получении сообщений
3. **Настроить переменные окружения** для Wahelp API
4. **Протестировать** отправку сообщений

---

## Вопросы:

1. Есть ли у клиентского бота доступ к Wahelp API?
   - Нужны `WAHELP_LOGIN`, `WAHELP_PASSWORD` или `WAHELP_ACCESS_TOKEN`
   - Нужны `WAHELP_CLIENTS_PROJECT_ID` и `WAHELP_CLIENTS_CHANNEL_UUID`

2. Используется ли тот же Wahelp аккаунт для клиентского бота?
   - Или нужен отдельный?

3. Нужно ли отправлять ВСЕ сообщения в amoCRM?
   - Или только вопросы/заказы?

